# 예외 처리

- 본 내용은 [이것이 자바다 - 신용권]을 참고하여 정리하였습니다.
- [소스 코드 레퍼지토리](https://github.com/2dongyeop/thisisjava)로 이동하기

<br/>

> 1절. 멀티 스레드 개념
>
> 2절. 작업 스레드 생성과 실행
>
> 3절. 스레드 우선순위
> 
> 4절. 동기화 메소드와 동기화 블록
>
> 5절. 스레드 상태
>
> 6절. 스레드 상태 제어
> 
> 7절. 데몬 스레드
> 
> 8절. 스레드 그룹
>
> 9절. 스레드풀

<br/>

## 1. 멀티 스레드 개념
### 💡 프로세스와 스레드
- #### 프로세스(`Process`)란?
    - 운영체제에서는 실행 중인 하나의 애플리케이션을 프로세스(process)라고 부른다. 
    - 사용자가 애플리케이션을 실행하면 운영체제로부터 실행에 필요한 메모리를 할당받아 애플리케이션의 코드를 실행하는데 이것이 프로세스이다.

<br/>

- #### 멀티 태스킹(`multi tasking`)이란?
    - 멀티 태스킹은 두 가지 이상의 작업을 동시에 처리하는 것을 말한다.
    - 운영체제는 멀티 태스킹이 가능하도록 CPU와 메모리 자원을 프로세스마다 적절히 할당해주고, 병렬로 실행시킨다. 
        - ex) 워드로 문서 작업을 하면서, 동시에 원도우 미디어 플레이어로 음악을 듣는것

<br/>

> 단, 멀티 태스킹이 무조건 멀티 프로세스를 뜻하는 것은 아니다.
> 
> → 한 프로세스 내에서 멀티 태스킹을 할 수 있도록 만들어진 애플리케이션이 있다.
>
> → ex) 미디어 플레이어: 동영상 재생과 음악 재생이라는 두 작업을 동시에 처리

<br/>

- #### 스레드(`Thread`)란?
    - 하나의 스레드는 하나의 코드 실행 흐름이다.
        -  한 프로세스 내에서 스레드가 두 개라면 두 개의 코드 실행 흐름이 생긴다는 의미이다.

<br/>

- #### 멀티 프로세스와 멀티 스레드
    - 멀티 프로세스
        - 운영체제에서 할당받은 자신의 메모리를 가지고 실행해 독립적이다.
        - 따라서 하나의 프로세스에서 오류가 발생해도 다른 프로세스에 영향이 없다.
        - ex) 워드와 엑셀을 동시에 사용하던 도중 워드에 오류가 생겨서 먹통이 되더라도 엑셀은 사용 가능하다.

    <br/>

    - 멀티 스레드
        - 하나의 프로세스 내부에 생성된다.
            - 따라서 하나의 스레드가 예외를 발생시키면 프로세스 자체가 종료될 수가 있어, 다른 스레드에 영향을 미치게 된다.
            - ex) 멀티 스레드로 동작하는 메신저의 경우 파일을 전송하는 스레드에서 예외가 발생되면, 메신저 프로세스 자체가 종료되기 때문에 채팅 스레드도 같이 종료된다.
        - 대용량 데이터의 처리 시간을 줄이기 위해 데이터를 분할해서 병렬로 처리하는 곳에서 사용한다.

<br/>

<br/>

### 💡 메인 스레드
> 모든 자바 애플리케이션은 메인 스레드(`main thread`)가 `main()` 메소드를 실행하면서 시작된다. 
>
> 메인 스레드는 `main()` 메소드의 첫 코드부터 아래로 순차적으로 실행하고, 
> 
> `main()` 메소드의 마지막 코드를 실행하거나, `return`문을 만나면 실행이 종료된다.

<br/>

단, **메인 스레드는 필요에 따라 작업 스레드들을 만들어 병렬로 코드를 작성**할 수 있다. 
- 즉, 멀티 스레드를 생성해 멀티 태스킹을 수행한다.
    - 싱글 스레드 애플리케이션은 메인 스레드가 종료되면 프로세스도 종료된다.
    - 멀티 스레드 애플리케이션은 실행 중인 스레드가 하나라도 있다면, 종료되지 않는다.
        - 메인 스레드가 작업 스레드보다 먼저 종료되어도 작업 스레드가 실행중이면 기다린다.

<br/>

<br/>

## 2. 작업 스레드 생성과 실행
- 멀티 스레드로 실행하는 애플리케이션을 개발하려면?
    - 먼저 몇 개의 작업을 병렬로 실행할지 결정하고 각 작업별로 스레드를 생성하여야 한다.

<br/>

- 자바에서는 작업 스레드도 객체로 생성되기 때문에 클래스가 필요하다. 
    - `java.lang.Thread` 클래스를 직접 객체화해서 생성해도 되지만,
    - `Thread`를 상속해서 하위 클래스를 만들어 낼 수도 있다.

<br/>

<br/>

### 💡 `Thread` 클래스로부터 직접 생성
- `Runnable`을 매개값으로 갖는 생성자를 호출하기
    ```java
    Thread thread = new Thread(Runnable target);
    ```
    - `Runnable`은 작업 스레드가 실행할 수 있는 코드(`run()`)를 가지고 있는 객체로,
    -  인터페이스 타입이기 때문에 구현 객체를 만들어 대입해야 한다.

<br/>

- `Runnable` 구현클래스 작성하기
    ```java
    class Task implements Runnable {
	    public void run() {
		    //스레드가 실행할 코드
	    }
    }
    ```
    - `Runnable`은 작업 내용을 가지고 있는 객체이지 실제 스레드가 아니다.
    - 구현 객체를 생성한 후 매개값으로 Thread 생성자를 호출하면 **작업 스레드가 생성**된다.

<br/>

- 익명 객체를 이용한 방법
    ```java
    Thread thread = new Thread(new Runnable() {  //익명 구현 객체
	    public void run() {
		    //스레드가 실행할 코드
	    }
    });
    ```
    - 코드를 절약하기 위한 방법으로, 이 방법이 주로 사용된다.

<br/>

- 작업스레드 실행하기
    ```java
    thread.start();
    ```
    - 작업 스레드는 생성되는 즉시 실행되는 것이 아니라, `start()` 메소드를 호출해야 비로소 실행된다.

<br/>

<br/>
